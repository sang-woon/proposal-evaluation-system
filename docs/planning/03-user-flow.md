# User Flow (사용자 흐름도)

> Mermaid 플로우차트로 핵심 기능의 주요 여정을 표현합니다.

---

## MVP 캡슐

| # | 항목 | 내용 |
|---|------|------|
| 1 | 목표 | 제안서 평가 결과 자동 집계 및 평가서 출력 |
| 2 | 페르소나 | 외부 전문가 평가위원 |
| 3 | 핵심 기능 | FEAT-1: 평가 결과 자동 집계 + A4 평가서 출력 |
| 4 | 성공 지표 (노스스타) | 모든 평가서 정상 출력 |
| 5 | 입력 지표 | 평가 항목별 점수 입력 완료율 |
| 6 | 비기능 요구 | 깔끔하고 단순한 UI, 공식적 톤앤매너 |
| 7 | Out-of-scope | 로그인 시스템, 모바일 앱, 복잡한 권한 관리 |
| 8 | Top 리스크 | A4 출력 시 레이아웃 깨짐 |
| 9 | 완화/실험 | 브라우저 인쇄 기능 테스트 (CSS @print) |
| 10 | 다음 단계 | 평가 항목 구조 정의 |

---

## 1. 전체 사용자 여정 (Overview)

```mermaid
graph TD
    A[웹 접속] --> B[메인 화면]
    B --> C{역할 선택}
    C -->|평가위원| D[FEAT-1: 평가 입력]
    C -->|관리자| E[결과 집계 조회]

    D --> F[제안서 선택]
    F --> G[점수 입력]
    G --> H{모든 항목 입력?}
    H -->|No| G
    H -->|Yes| I[저장]
    I --> J{다음 제안서?}
    J -->|Yes| F
    J -->|No| K[평가서 출력]
    K --> L[A4 인쇄]
    L --> M[서명 후 제출]

    E --> N[전체 집계 확인]
    N --> O[결과 다운로드/출력]
```

---

## 2. FEAT-0: 접속 플로우

```mermaid
graph TD
    A[브라우저 열기] --> B[URL 입력]
    B --> C[앱 로딩]
    C --> D{로딩 성공?}

    D -->|Yes| E[메인 화면 표시]
    D -->|No| F[에러 메시지]
    F --> G[새로고침 안내]
    G --> B

    E --> H[역할/기능 선택]
    H --> I[평가 입력 페이지]
    H --> J[결과 집계 페이지]
```

---

## 3. FEAT-1: 평가 입력 플로우

```mermaid
graph TD
    A[평가 입력 페이지] --> B[평가위원명 입력]
    B --> C[제안서 목록 표시]
    C --> D[제안서 선택]

    D --> E[평가 항목 표시]
    E --> F[항목1: 기술성 점수]
    F --> G[항목2: 경제성 점수]
    G --> H[항목3: 사업성 점수]
    H --> I[기타 항목들...]

    I --> J{점수 범위 검증}
    J -->|범위 초과| K[경고 메시지]
    K --> F
    J -->|정상| L[합계 자동 계산]

    L --> M[저장 버튼]
    M --> N{저장 성공?}
    N -->|Yes| O[성공 메시지]
    N -->|No| P[에러 안내]
    P --> M

    O --> Q{다른 제안서?}
    Q -->|Yes| C
    Q -->|No| R[평가서 출력으로]
```

---

## 4. FEAT-1: 평가서 출력 플로우

```mermaid
graph TD
    A[평가서 출력 페이지] --> B[평가위원 선택]
    B --> C[평가 내역 조회]
    C --> D[평가서 미리보기]

    D --> E{레이아웃 확인}
    E -->|정상| F[인쇄 버튼]
    E -->|문제| G[레이아웃 조정]
    G --> D

    F --> H[브라우저 인쇄 대화상자]
    H --> I{프린터 선택}
    I --> J[A4 용지 설정]
    J --> K[인쇄 실행]

    K --> L{인쇄 성공?}
    L -->|Yes| M[서명란에 서명]
    L -->|No| N[PDF 저장 대안]
    N --> O[PDF 파일 생성]
    O --> P[USB/이메일로 전송]
    P --> Q[다른 프린터에서 출력]

    M --> R[평가 완료]
```

---

## 5. 결과 집계 플로우 (관리자 화면)

```mermaid
graph TD
    A[결과 집계 페이지] --> B[제안서별 집계]
    B --> C[평가위원별 점수 표시]
    C --> D[평균/합계 자동 계산]

    D --> E[순위 표시]
    E --> F{내보내기?}

    F -->|CSV| G[CSV 다운로드]
    F -->|출력| H[집계표 인쇄]
    F -->|화면 확인| I[결과 확인 완료]

    G --> I
    H --> I
```

---

## 6. 에러 처리 플로우

```mermaid
graph TD
    A[에러 발생] --> B{에러 유형?}

    B -->|네트워크| C[연결 재시도 안내]
    B -->|입력 오류| D[필드별 에러 표시]
    B -->|저장 실패| E[재시도 버튼]
    B -->|서버 오류| F[잠시 후 재시도 안내]

    C --> G{재시도?}
    G -->|Yes| H[페이지 새로고침]
    G -->|No| I[오프라인 작업 안내]

    D --> J[사용자 수정]
    J --> K[재저장]

    E --> L{재시도 성공?}
    L -->|Yes| M[저장 완료]
    L -->|No| N[수동 기록 안내]

    F --> O[고객지원 연락처 표시]
```

---

## 7. 화면 목록 (Screen Inventory)

| 화면 ID | 화면명 | FEAT | 진입점 | 주요 액션 |
|---------|--------|------|--------|----------|
| S-01 | 메인 화면 | FEAT-0 | 앱 실행 | 기능 선택 |
| S-02 | 평가 입력 | FEAT-1 | S-01 | 평가위원명 입력, 제안서 선택 |
| S-03 | 점수 입력 | FEAT-1 | S-02 | 항목별 점수 입력, 저장 |
| S-04 | 평가서 출력 | FEAT-1 | S-02, S-03 | 미리보기, 인쇄 |
| S-05 | 결과 집계 | FEAT-1 | S-01 | 전체 집계 조회, 내보내기 |

---

## 8. 상태 전이 다이어그램

```mermaid
stateDiagram-v2
    [*] --> 대기중: 앱 접속
    대기중 --> 입력중: 제안서 선택
    입력중 --> 입력중: 점수 입력
    입력중 --> 저장완료: 저장 버튼
    저장완료 --> 입력중: 다음 제안서
    저장완료 --> 출력준비: 모든 평가 완료
    출력준비 --> 출력완료: 인쇄 실행
    출력완료 --> [*]: 서명 완료

    입력중 --> 에러: 저장 실패
    에러 --> 입력중: 재시도
```

---

## Decision Log 참조

| ID | 항목 | 선택 | 근거 |
|----|------|------|------|
| D-08 | 페이지 구조 | 단일 앱, 다중 페이지 | Streamlit 페이지 기능 활용 |
| D-09 | 평가 흐름 | 제안서별 순차 입력 | 평가위원 작업 흐름에 맞춤 |
| D-10 | 출력 방식 | 브라우저 인쇄 | 별도 라이브러리 없이 가장 단순 |
